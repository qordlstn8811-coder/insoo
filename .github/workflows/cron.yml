name: Blog Post Cron

on:
  schedule:
    # 15분마다 실행 (하루 96회 * 1개 = 약 100개 발행)
    # 한 번에 많이 요청하는 것보다 자주 호출하여 타임아웃/Gemini 제한을 피하는 것이 훨씬 안정적입니다.
    - cron: '*/15 * * * *'
  workflow_dispatch: # 수동 실행 버튼

jobs:
  trigger-cron:
    runs-on: ubuntu-latest
    steps:
      - name: Call Vercel Cron API
        run: |
          # [Fixed] Hardcoded domain to ensure stability
          # Target: https://www.전북하수구막힘.com (Punycode: xn--2e0bm8utzck3fsyi7rvktd.com)
          URL="https://www.xn--2e0bm8utzck3fsyi7rvktd.com"
          
          echo "Triggering Blog Post Generation to: $URL"
          
          # 안정성을 위해 한 번에 1개씩만 생성 (15분 간격)
          curl -X GET "$URL/api/cron?limit=1" \
          -H "Authorization: Bearer ${{ secrets.CRON_SECRET }}" \
          --fail || exit 1
