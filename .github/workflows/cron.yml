name: Blog Post Cron

on:
  schedule:
    # 1시간마다 실행 (매시 0분) -> 하루 24회 * 5개 = 120개 발행
    - cron: '0 * * * *'
  workflow_dispatch: # 수동 실행 버튼

jobs:
  trigger-cron:
    runs-on: ubuntu-latest
    steps:
      - name: Call Vercel Cron API
        run: |
          # [Fixed] Hardcoded domain to ensure stability
          # Target: https://www.전북하수구막힘.com (Punycode: xn--2e0bm8utzck3fsyi7rvktd.com)
          URL="https://www.xn--2e0bm8utzck3fsyi7rvktd.com"
          
          echo "Triggering Blog Post Generation to: $URL"
          
          # CRON_SECRET을 헤더에 담아 호출 (한 번에 5개 생성)
          curl -X GET "$URL/api/cron?limit=5" \
          -H "Authorization: Bearer ${{ secrets.CRON_SECRET }}" \
          --fail || exit 1
