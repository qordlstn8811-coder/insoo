{
  "meta": {
    "project": "Customer Inquiry Contact Form API",
    "date": "2025-12-10",
    "prepared_by": "Software Development Manager"
  },
  "product_overview": "This product is a Contact Form API designed to handle customer inquiry submissions for a client website. It provides validation of user input, stores inquiry data securely in a Supabase database, and sends Telegram notifications to alert about new inquiries.",
  "core_goals": [
    "Provide a secure and reliable API for submitting contact inquiries.",
    "Ensure user inputs are properly validated, especially phone number formats specific to Korea.",
    "Save all inquiry submissions persistently in a Supabase database for future reference and management.",
    "Send timely Telegram notifications to designated chat to alert of new inquiries while protecting sensitive bot credentials.",
    "Prevent invalid or malformed inquiries from being processed by enforcing strict input validation rules and error handling."
  ],
  "key_features": [
    "POST /api/contact endpoint to accept contact form submissions with JSON payload.",
    "Validation of required fields: name, phone, and region are mandatory; message is optional.",
    "Phone number validation using a Korean phone format regular expression.",
    "Data persistence to Supabase backend for storing inquiries.",
    "Telegram notification integration that sends alert messages without exposing bot tokens in codebase.",
    "Environment variable management to safeguard sensitive tokens and IDs, preventing hardcoded secrets.",
    "Consistent API response codes: 200 on success, 400 on validation error, and 500 on server or DB errors.",
    "Frontend integration tested via manual testing at /contact endpoint with user submissions."
  ],
  "user_flow_summary": [
    "User navigates to the contact form page and enters inquiry details including name, phone, region, and optional message.",
    "On form submission, client sends a POST request to /api/contact with the data in JSON format.",
    "API validates all required fields and applies regex check on phone number format.",
    "If validation fails, API returns HTTP 400 with corresponding error message.",
    "If validation passes, inquiry data is saved in Supabase database securely.",
    "API triggers Telegram notification to inform the support team about the new inquiry.",
    "User receives a successful response confirming inquiry submission even if Telegram notification fails to avoid blocking user.",
    "User may verify data persistence by reviewing Supabase dashboard or confirm notification reception via Telegram chat."
  ],
  "validation_criteria": [
    "Manual testing of contact form submission at /contact endpoint with various input cases.",
    "Verify that phone numbers not matching Korean format are rejected with 400 errors.",
    "Ensure that the Telegram bot token and chat ID are loaded from environment variables and not hardcoded in source code.",
    "Confirm that all inquiries are saved in Supabase database correctly with required fields.",
    "Validate that notification messages are sent to Telegram chat when inquiries are submitted, but failure does not affect user experience.",
    "Check frontend form fields align with backend expectations (message field is optional on both ends).",
    "Review code to ensure no unused imports and redundant client instantiations exist.",
    "Monitor for rate limiting implementation in future releases to protect against spam or abuse."
  ],
  "code_summary": {
    "tech_stack": [
      "TypeScript",
      "Next.js 16",
      "React 19",
      "Supabase",
      "Tailwind CSS"
    ],
    "features": [
      {
        "name": "Contact Form API",
        "description": "Handles contact form submissions. Validates input, saves to Supabase database, and sends Telegram notifications.",
        "files": [
          "src/app/api/contact/route.ts"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "info": {
            "title": "Contact API",
            "version": "1.0.0"
          },
          "paths": {
            "/api/contact": {
              "post": {
                "summary": "Submit contact form",
                "description": "Submits a contact form inquiry. Validates required fields and phone format, saves to Supabase, and sends Telegram notification.",
                "requestBody": {
                  "required": true,
                  "content": {
                    "application/json": {
                      "schema": {
                        "type": "object",
                        "required": [
                          "name",
                          "phone",
                          "region"
                        ],
                        "properties": {
                          "name": {
                            "type": "string",
                            "description": "Customer name"
                          },
                          "phone": {
                            "type": "string",
                            "description": "Phone number (Korean format: 010-XXXX-XXXX)",
                            "pattern": "^01[016789]-?\\d{3,4}-?\\d{4}$"
                          },
                          "region": {
                            "type": "string",
                            "description": "Customer region"
                          },
                          "message": {
                            "type": "string",
                            "description": "Optional inquiry message"
                          }
                        }
                      }
                    }
                  }
                },
                "responses": {
                  "200": {
                    "description": "Inquiry submitted successfully",
                    "content": {
                      "application/json": {
                        "schema": {
                          "type": "object",
                          "properties": {
                            "message": {
                              "type": "string"
                            },
                            "data": {
                              "type": "object"
                            }
                          }
                        }
                      }
                    }
                  },
                  "400": {
                    "description": "Validation error - missing required fields or invalid phone format"
                  },
                  "500": {
                    "description": "Server error - database or internal error"
                  }
                }
              }
            }
          }
        }
      }
    ]
  }
}
